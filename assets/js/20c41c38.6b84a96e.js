"use strict";(self.webpackChunkcloud=self.webpackChunkcloud||[]).push([[6753],{3905:(e,n,r)=>{r.d(n,{Zo:()=>d,kt:()=>u});var a=r(7294);function t(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(e,n){if(null==e)return{};var r,a,t=function(e,n){if(null==e)return{};var r,a,t={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],n.indexOf(r)>=0||(t[r]=e[r]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var l=a.createContext({}),p=function(e){var n=a.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},d=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var r=e.components,t=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=p(r),u=t,k=c["".concat(l,".").concat(u)]||c[u]||m[u]||o;return r?a.createElement(k,s(s({ref:n},d),{},{components:r})):a.createElement(k,s({ref:n},d))}));function u(e,n){var r=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=r.length,s=new Array(o);s[0]=c;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i.mdxType="string"==typeof e?e:t,s[1]=i;for(var p=2;p<o;p++)s[p]=r[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,r)}c.displayName="MDXCreateElement"},315:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=r(7462),t=(r(7294),r(3905));const o={},s="Performance",i={unversionedId:"linux/linux_perf",id:"linux/linux_perf",title:"Performance",description:"Blue Diamond related things",source:"@site/docs/linux/linux_perf.md",sourceDirName:"linux",slug:"/linux/linux_perf",permalink:"/cloud/docs/linux/linux_perf",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/linux/linux_perf.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Misc (Linux)",permalink:"/cloud/docs/linux/linux_misc"},next:{title:"minikube",permalink:"/cloud/docs/minikube"}},l={},p=[{value:"Contents",id:"contents",level:2},{value:"Resources and links",id:"resources-and-links",level:2},{value:"commands",id:"commands",level:2},{value:"Accessbility  and usability",id:"accessbility--and-usability",level:3},{value:"Git",id:"git",level:4},{value:"Reader&#39;s comments",id:"readers-comments",level:2},{value:"Replay timeline",id:"replay-timeline",level:3},{value:"Operations",id:"operations",level:2},{value:"git on blue diamond",id:"git-on-blue-diamond",level:3},{value:"ppcle <code>bapy7602</code>",id:"ppcle-bapy7602",level:4},{value:"Session #2. 20220303 #scenario 2 #OS (Benny)",id:"session-2-20220303-scenario-2-os-benny",level:3},{value:"Session #3. 20220303 scenario 3 #OS (Benny)",id:"session-3-20220303-scenario-3-os-benny",level:3},{value:"AP team hands-on note",id:"ap-team-hands-on-note",level:2},{value:"Situation 1 : OS",id:"situation-1--os",level:3},{value:"Scenario #1 System is Paging/Swapping",id:"scenario-1-system-is-pagingswapping",level:4},{value:"Webex chat backup",id:"webex-chat-backup",level:4},{value:"Scenario #2 High User CPU",id:"scenario-2-high-user-cpu",level:4}],d={toc:p};function m(e){let{components:n,...r}=e;return(0,t.kt)("wrapper",(0,a.Z)({},d,r,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"performance"},"Performance"),(0,t.kt)("p",null,"Blue Diamond related things"),(0,t.kt)("h2",{id:"contents"},"Contents"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#performance"},"Performance"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#contents"},"Contents")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#resources-and-links"},"Resources and links")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#commands"},"commands"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#accessbility--and-usability"},"Accessbility  and usability"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#git"},"Git")))))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#readers-comments"},"Reader's comments"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#replay-timeline"},"Replay timeline")))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#operations"},"Operations"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#git-on-blue-diamond"},"git on blue diamond"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#ppcle-bapy7602"},"ppcle ",(0,t.kt)("inlineCode",{parentName:"a"},"bapy7602"))))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#session-2-20220303-scenario-2-os-benny"},"Session #2. 20220303 #scenario 2 #OS (Benny)")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#session-3-20220303-scenario-3-os-benny"},"Session #3. 20220303 scenario 3 #OS (Benny)")))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#ap-team-hands-on-note"},"AP team hands-on note"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#situation-1--os"},"Situation 1 : OS"),(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#scenario-1-system-is-pagingswapping"},"Scenario #1 System is Paging/Swapping")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#webex-chat-backup"},"Webex chat backup")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#scenario-2-high-user-cpu"},"Scenario #2 High User CPU"))))))))),(0,t.kt)("h2",{id:"resources-and-links"},"Resources and links"),(0,t.kt)("p",null,(0,t.kt)("a",{parentName:"p",href:"https://bdam.svl.ibm.com/AM/"},"BD access management"),"    => Log in by intranet id / pw.",(0,t.kt)("br",{parentName:"p"}),"\n",(0,t.kt)("a",{parentName:"p",href:"https://oneticket.devit.ibm.com"},"oneticket")," => Open for a problem.  Search by ",(0,t.kt)("inlineCode",{parentName:"p"},"blu"),", then ",(0,t.kt)("inlineCode",{parentName:"p"},"GDPR")," will show up.",(0,t.kt)("br",{parentName:"p"}),"\n",(0,t.kt)("a",{parentName:"p",href:"https://w3.ibm.com/w3publisher/db2-client-success/how-we-do/support-process/blue-diamond-need-to-know"},"Sending file to customer"),"       "),(0,t.kt)("p",null,"DB2 tools related path   ",(0,t.kt)("inlineCode",{parentName:"p"},"/db2_only_data/DB2_TOOLS_LNX/v115m7fp0_linuxamd64_internaltools"),"     "),(0,t.kt)("h2",{id:"commands"},"commands"),(0,t.kt)("p",null,"Redhat"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"yum -y install sos\nsosreport -a --batch\n")),(0,t.kt)("p",null,"SuSe"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"supportconfig -Al\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[CRE-General_User-All_Shared-*-*-AIX_p-zipa7101]\n[CRE-General_User-All_Shared-*-*-Linux_x-zixr6601]\n[CRE-General_User-All_Shared-*-*-Linux_x-zixr7804]\n[CRE-General_User-All_Shared-*-*-Windows_x-zixw1601]\n[CRE-General_User-All_Shared-*-*-Windows_x-zixw1602]\n[CRE-General_User-All_Shared-*-*-Windows_x-zixw1604]\n[CRE-General_User-Restricted-Cloud-DB2LUW-AIX_p-zipa7108]\n[CRE-General_User-Restricted-Cloud-DB2LUW-Linux_x-zixr6602]\n[STD-General_User-All_Shared-*-*-AIX_p-aixbd05]\n[STD-General_User-All_Shared-*-*-FTP_Folder-All_Customers]\n[STD-General_User-All_Shared-*-*-Linux_x-aaxr0701]\n[STD-General_User-All_Shared-*-*-Windows_x-aaxw1605]\n[STD-General_User-BU_Shared-C&CS-DB2LUW-Linux_p-bapy7301]\n[STD-General_User-Restricted-Cloud-DB2-Tool-DB2ADM1]\n[STD-General_User-Restricted-Cloud-DB2LUW-AIX_p-zrpa7101]\n[STD-General_User-Restricted-Cloud-DB2LUW-AIX_p-zrpa7102]\n[STD-General_User-Restricted-Cloud-DB2LUW-Linux_x-zrxr6601]\n[STD-General_User-Restricted-Cloud-DB2LUW-Solaris_s-zrsl1101]\n[STD-General_User-Restricted-Cloud-DB2LUW-Tool-BDClearCaseUDBUnix]\n")),(0,t.kt)("h3",{id:"accessbility--and-usability"},"Accessbility  and usability"),(0,t.kt)("h4",{id:"git"},"Git"),(0,t.kt)("ul",{className:"contains-task-list"},(0,t.kt)("li",{parentName:"ul",className:"task-list-item"},(0,t.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ",(0,t.kt)("inlineCode",{parentName:"li"},"baxr7801")," for linuxamd64    => Error         "),(0,t.kt)("li",{parentName:"ul",className:"task-list-item"},(0,t.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,t.kt)("inlineCode",{parentName:"li"},"bapy7602")," for ppcle64le        ")),(0,t.kt)("h2",{id:"readers-comments"},"Reader's comments"),(0,t.kt)("h3",{id:"replay-timeline"},"Replay timeline"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"This series are presented by APD mates by group. ( Rajib, Benny and Kamil)    ")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"It seems documents in the ",(0,t.kt)("a",{parentName:"p",href:"https://github.ibm.com/DB2-APD/Education/tree/master/Perf_Advanced"},"link")," will be upddate adding topics continuously.",(0,t.kt)("br",{parentName:"p"}),"\n","So, I recommend to check the docs in regular basis.",(0,t.kt)("br",{parentName:"p"}),"\n","(Cloning the git repository is also good idea. I am doing that.)")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Check the table of contents from docs before jumping into replay videos.",(0,t.kt)("br",{parentName:"p"}),"\n","That would be the trailer what may be discussed.    ")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"You may use the doc as a handbook or adding to your note based on what you leanred newly.    ")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Excercise uses fyre stencil.     ")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Hands-on outputs on this page referred APD Rajib's doc in DB2-APD/education github.     "))),(0,t.kt)("h2",{id:"operations"},"Operations"),(0,t.kt)("h3",{id:"git-on-blue-diamond"},"git on blue diamond"),(0,t.kt)("p",null,"Basically, few systems which runs Db2 development containers.",(0,t.kt)("br",{parentName:"p"}),"\n",(0,t.kt)("a",{parentName:"p",href:"https://pages.github.ibm.com/DB2/db2-dev-playbook/support/bd.html?highlight=blue%20diamond"},"Reference page in playbood"),"    "),(0,t.kt)("h4",{id:"ppcle-bapy7602"},"ppcle ",(0,t.kt)("inlineCode",{parentName:"h4"},"bapy7602")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Check if ",(0,t.kt)("inlineCode",{parentName:"li"},"docker")," group is set.",(0,t.kt)("br",{parentName:"li"}),"If not, ask ",(0,t.kt)("inlineCode",{parentName:"li"},"BD admin")," to add.       ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"\n-sh-4.2$ hostname\nbapy7602\n\n-sh-4.2$ id\nuid=15671(junsule) gid=50384(bdudbcc) groups=50384(bdudbcc),12042(domain users),  12047(urhelbd01),50003(db2adm1),50006(uaixbd05),50216(uzixr6601),50220(uzipa7101  ),50400(uzixr6602),50401(uzrxr6601),50405(uzrpa7101),50406(uzipa7108),50602(usrc  itrixstd),50620(usrcitrixcre),50650(uzrsl1101),50746(ubapy7301),50804(uaaxr0701)  ,50822(uzrpa7102),50846(uzixr7804) context=unconfined_u:unconfined_r:unconfined_  t:s0-s0:c0.c1023\n\n")),(0,t.kt)("h3",{id:"session-2-20220303-scenario-2-os-benny"},(0,t.kt)("a",{parentName:"h3",href:"https://ibm.ent.box.com/file/941459653487?s=bey62x3sl1b8zw6l4z1dl5veb68jy3qb"},"Session #2. 20220303 #scenario 2 #OS (Benny)")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"(05:16~ ) Session 1 recap.\nTo see as MB, ",(0,t.kt)("inlineCode",{parentName:"li"},"vmstat -S M -w 5"),"      "),(0,t.kt)("li",{parentName:"ul"},"(16:13 ~ ) Finding process consuming CPU   ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"ps -o pid,user,%mem,command ax | sort -b -k3 -r\n")),(0,t.kt)("h3",{id:"session-3-20220303-scenario-3-os-benny"},(0,t.kt)("a",{parentName:"h3",href:"https://ibm.ent.box.com/file/941465225796?s=wu4by98xlanxpef353vp662dt6kwf57r"},"Session #3. 20220303 scenario 3 #OS (Benny)")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#Contents"},"Go to content"))),(0,t.kt)("h2",{id:"ap-team-hands-on-note"},"AP team hands-on note"),(0,t.kt)("h3",{id:"situation-1--os"},"Situation 1 : OS"),(0,t.kt)("h4",{id:"scenario-1-system-is-pagingswapping"},"Scenario #1 System is Paging/Swapping"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"Test system : lumenal1.fyre.ibm.com , UID = root ( Ask password to Jun Su or Guo Dong )")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Reboot to start from clean status")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Run vmstat on terminal 1 before starting problem and monitor.       "))),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"# vmstat -w 1\nprocs -----------------------memory---------------------- ---swap-- -----io---- -system-- --------cpu--------\n r  b         swpd         free         buff        cache   si   so    bi    bo   in   cs  us  sy  id  wa  st\n ...\n 0  0            0      6366004         2108      1397888    0    0     0     2  186  156   0   0 100   0   0\n 0  0            0      6366004         2108      1397888    0    0     0     0  144  108   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     0  146  104   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     8  152  103   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     0  149  103   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     0  152  103   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     0  158  112   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     0  147  104   0   0 100   0   0\n 0  0            0      6366020         2108      1397888    0    0     0     0  149  103   0   0 100   0   0\n 6  0            0      4986688         2108      1535772    0    0   184    25  513  305   2   4  94   0   0\n 1  2      3477248       104068            0       203828   58 349994  1215 350004 35052 5594  11  45   9  36   0    <=== \n 3  5      8852224       104440            0       307580   20 535345   281 535345 62310 7953   8  53   6  33   0\n 3  6     13828352       103092            0       269812   40 499186   102 499186 63651 10080   7  57   2  34   0\n 8  3     15826024       103644            0       191624  489 499072  2120 499084 65229 11408   9  63   0  28   0\nprocs -----------------------memory---------------------- ---swap-- -----io---- -system-- --------cpu--------\n r  b         swpd         free         buff        cache   si   so    bi    bo   in   cs  us  sy  id  wa  st\n 8  1       612740       103000            0       229804  153 175743  2530 175745 25921 6498  11  45  33  11   0\n")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"Check which users : cat /etc/passwd   # search for users starting recipe")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Switch user ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 ~]# su - recipe1\nLast login: Wed May 25 19:11:36 PDT 2022 on pts/1\n\n==================================================\n\nThis recipe1 is simulating a Paging situation\n\nStart by using the command: vmstat -S M -w 5 or vmstat command you like to gauge the situation on the system\n\nRefer to the document: AnalyzingAndDebuggingPerfProblems.docx and go over the vmstat column section to understand the output\n\nAfter that check the Red Flags section in the document and see if any of those red flags match what you are seeing here\n\nTry and get the commands you can use from the document to use and then\n\n Try and answer the following questions:\n    1.Which user is using the most memory?\n    2.How much swap memory is being used?\n    3.Do you see variation in free memory on the box?\n    4.Which process(es) are driving the swap memory usage?\n    5.Was the OOM-Killer invoked? How will you find it out? (Hint: Use dmesg)\n    6.After you log out, do you still see Swap memory usage? If yes, find out which process(es) is/are still using the swap memory.\n\nFeel free to go back to the reference document and Answer Key\n\nThe answer key and reference document is available at:\n\nBox: https://ibm.box.com/s/9fa79a1hdbbyaqdcy8yrfh02b0unia40\n\nGithub: https://github.ibm.com/DB2-APD/Education/tree/master/Perf_Advanced\n\n==================================================\n")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Sense what might be running under the user.   ( ",(0,t.kt)("inlineCode",{parentName:"li"},"prog4")," ?)")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ ps\n  PID TTY          TIME CMD\n31012 pts/1    00:00:00 bash\n31035 pts/1    00:00:00 bash\n31316 pts/1    00:00:00 prog4\n31317 pts/1    00:00:00 sleep\n31334 pts/1    00:00:07 prog4\n31335 pts/1    00:00:07 prog4\n31346 pts/1    00:00:00 ps\n")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"C Source : pegmem_Linux.c ")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Sense what is triggered swithcing to this user    ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"[recipe1@lumenal1 ~]$ cat .bashrc\n# .bashrc\n\n# Source global definitions\nif [ -f /etc/bashrc ]; then\n    . /etc/bashrc\nfi\n\nperl /.scripts/print_banner.pl recipe1 \n\n( nohup /.scripts/run_prog4 > /dev/null 2>&1 & )\n..\n")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Find out the ",(0,t.kt)("inlineCode",{parentName:"li"},"red flags"),"    ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"$ top\n..\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n32270 recipe1   20   0 1335416   1.1g    248 R  56.0 14.2   0:01.68 prog4\n32271 recipe1   20   0 1028216 956548  34860 R  44.7 11.9   0:01.34 prog4\n32273 recipe1   20   0 1028216 969484  47796 R  44.3 12.1   0:01.33 prog4\n32269 recipe1   20   0  925816 838044  18756 R  39.3 10.5   0:01.18 prog4\n32268 recipe1   20   0  925816 788416    252 R  37.7  9.8   0:01.13 prog4\n32272 recipe1   20   0  823416 644828    248 R  31.3  8.1   0:00.94 prog4\n32166 recipe1   20   0  162124   1008    648 R   0.3  0.0   0:00.29 top\n")),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"Which user is using the most memory ",(0,t.kt)("inlineCode",{parentName:"li"},"ps aux"),"    ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ ps aux|awk '{ print $1\" \"$4; }'|sort |perl -ne 'chomp($_); @arr=split(/\\s+/,$_); $user=$arr[0]; $pct=$arr[1]; $hash{$user} += $pct; END{ foreach $user( sort { $hash{$b} <=> $hash{$a} } keys %hash){ $val = $hash{$user}; printf(\"%30s => %6s\\n\", $user, $val); } }'\n                       recipe1 =>     90\n                           ntp =>      0\n                           rpc =>      0\n                       polkitd =>      0\n                          root =>      0\n                          USER =>      0\n                          dbus =>      0\n")),(0,t.kt)("p",null,"interested colum %MEM -> split by space.-> save to array -> print by order"),(0,t.kt)("ol",{start:2},(0,t.kt)("li",{parentName:"ol"},"How much swap memoryt is being used  ?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ free -h\n              total        used        free      shared  buff/cache   available\nMem:           7.6G        7.2G        100M        296M        322M         30M\nSwap:           15G         11G        4.1G\n")),(0,t.kt)("ol",{start:3},(0,t.kt)("li",{parentName:"ol"},"Do you see variation in free memory on the box ?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"watch free -h\n")),(0,t.kt)("ol",{start:4},(0,t.kt)("li",{parentName:"ol"},"Which processes are driving the swap memory usage ? ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ ps aux | head -n 1 ; ps aux | sort -rnk 4|head -n 10\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nrecipe1   1599 35.2 16.7 2666616 1345028 pts/2 R    19:50   0:06 /.scripts/prog4 6\nrecipe1   1597 37.5 16.3 2564216 1306444 pts/2 R    19:50   0:06 /.scripts/prog4 6\nrecipe1   1600 35.3 15.7 2666616 1262372 pts/2 R    19:50   0:06 /.scripts/prog4 6\nrecipe1   1595 37.5 14.8 2769016 1186984 pts/2 R    19:50   0:06 /.scripts/prog4 6\nrecipe1   1596 36.6 14.1 2564216 1135236 pts/2 R    19:50   0:06 /.scripts/prog4 6\nrecipe1   1598 35.3 12.8 2257016 1032812 pts/2 R    19:50   0:06 /.scripts/prog4 6\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nrpc        711  0.0  0.0  69256    20 ?        Ss   May18   0:01 /sbin/rpcbind -w\nroot       923  0.0  0.0      0     0 ?        S    19:41   0:00 [kworker/3:2]\nroot       922  0.0  0.0      0     0 ?        S    19:41   0:00 [kworker/u8:1]\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ ps aux --sort -%mem | head -n 10\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nrecipe1   1666 65.4 44.3 4919416 3553764 pts/2 R    19:50   0:07 /.scripts/prog4 2\nrecipe1   1667 65.9 43.7 4817016 3506916 pts/2 R    19:50   0:07 /.scripts/prog4 2\nrecipe1   1684  0.0  0.0 155588  1968 pts/2    R+   19:51   0:00 ps aux --sort -%mem\nrecipe1    425  0.0  0.0 115544   824 pts/2    S    19:35   0:00 -bash\nroot      1321  0.0  0.0 586424   780 ?        Ssl  May18   1:12 /usr/bin/python2 -Es /usr/sbin/tuned -l -P\nrecipe1   1685  0.0  0.0 108064   680 pts/2    S+   19:51   0:00 head -n 10\nroot         1  0.0  0.0  51764   572 ?        Ss   May18   2:22 /usr/lib/systemd/systemd --switched-root --system --deserialize 22\nroot       655  0.0  0.0 1544016  424 ?        Sl   May18   1:52 falcon-sensor\nroot     30163  0.0  0.0 152704   380 pts/0    S+   18:54   0:01 vmstat -w 10\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ top -c -b -n 1 -o +%MEM\ntop - 19:51:46 up 7 days, 13:26,  2 users,  load average: 4.92, 4.91, 4.54\nTasks: 161 total,  12 running, 149 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  5.7 us, 53.7 sy,  0.0 ni,  8.1 id, 27.6 wa,  0.0 hi,  4.9 si,  0.0 st\nKiB Mem :  8008632 total,   103188 free,  7617788 used,   287656 buff/cache\nKiB Swap: 16773116 total,  8004092 free,  8769024 used.    31332 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n 1768 recipe1   20   0 2257016   1.0g    248 R  20.3 13.7   0:05.04 /.scripts/+\n 1764 recipe1   20   0 2154616 993652  39084 R  11.9 12.4   0:05.12 /.scripts/+\n 1765 recipe1   20   0 2052216 957080  79800 R   6.8 12.0   0:04.54 /.scripts/+\n 1762 recipe1   20   0 2052216 947788  10312 R  10.2 11.8   0:04.51 /.scripts/+\n 1763 recipe1   20   0 2359416 915048    248 R  11.9 11.4   0:05.26 /.scripts/+\n 1767 recipe1   20   0 1949816 906052  54660 R   6.8 11.3   0:04.45 /.scripts/+\n 1766 recipe1   20   0 1949816 814128  24036 R   6.8 10.2   0:04.61 /.scripts/+\n 1769 recipe1   20   0 1949816 792884  60996 R   5.1  9.9   0:04.48 /.scripts/+\n 1783 recipe1   20   0  162136   2192   1616 R   0.0  0.0   0:00.08 top -c -b +\n 1321 root      20   0  586424    812    340 S   0.0  0.0   1:12.61 /usr/bin/p+\n  425 recipe1   20   0  115544    768    564 S   0.0  0.0   0:00.27 -bash\n    1 root      20   0   51764    752    520 S   0.0  0.0   2:22.40 /usr/lib/s+\n\n")),(0,t.kt)("ol",{start:5},(0,t.kt)("li",{parentName:"ol"},"Was the OOM-Killer invoked? How will you find it out?  ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ dmesg | grep -i killer \n[650819.810820] prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[650825.823637] prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[650988.142427] falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[651141.398440] falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[651148.567848] falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[651303.150807] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[651310.151571] prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[651466.149885] prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[651628.140960] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[651635.151448] prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[651789.962089] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[651796.935745] prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[651953.153022] prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[651960.144949] prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[652113.193703] prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\n[652119.625988] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[652272.128827] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[652279.151914] falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[652597.152401] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[652604.144386] prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[652758.141355] systemd invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[652765.137828] prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[653040.190108] pkill invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\n[653084.143985] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n[653244.616146] prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ sudo grep -i killer /var/log/messages\nMay 25 19:12:16 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\nMay 25 19:12:21 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\nMay 25 19:15:04 lumenal1 kernel: falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:17:37 lumenal1 kernel: falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:17:44 lumenal1 kernel: falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:20:19 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:20:26 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:23:02 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:25:44 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:25:51 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\nMay 25 19:28:26 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:28:33 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\nMay 25 19:31:09 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:31:16 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\nMay 25 19:33:49 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x280da, order=0, oom_score_adj=0\nMay 25 19:33:55 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:36:28 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:36:35 lumenal1 kernel: falcon-sensor invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:41:53 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:42:00 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:44:34 lumenal1 kernel: systemd invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:44:41 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:49:16 lumenal1 kernel: pkill invoked oom-killer: gfp_mask=0x201da, order=0, oom_score_adj=0\nMay 25 19:50:00 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\nMay 25 19:52:40 lumenal1 kernel: prog4 invoked oom-killer: gfp_mask=0x200da, order=0, oom_score_adj=0\n")),(0,t.kt)("ol",{start:6},(0,t.kt)("li",{parentName:"ol"},"After you log out, do you still see Swap memory usage? If yes, find out which process(es) is/are still using the swap memory  ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe1@lumenal1 ~]$ exit\nlogout\n")),(0,t.kt)("p",null,"Memory usage decreases.   "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"\n# vmstat -w 1\nprocs -----------------------memory---------------------- ---swap-- -----io---- -system-- --------cpu--------\n r  b         swpd         free         buff        cache   si   so    bi    bo   in   cs  us  sy  id  wa  st\n 9  9     16218476       103116            0       157124   64 639751   154 639751 61814 9748   9  67   1  23   0\n 0  0        72868      7599104            0       236804  172 71895  1594 71907 7809 1725   2  22  73   3   0\n 9  1      2053500       104836            0       422144   82 201048    83 201048 19698 2217  11  35  48   6   0\n 1  7      8332332       102904            0       284520   58 627830    73 627830 75925 8275   9  64   1  26   0\n 1  6     14496940       103460            0       287976   50 613714   140 613716 73324 8295   9  66   0  25   0\n 4  6     16274848       103024            0        97432  292 480072  2349 480096 66993 12737   8  69   2  21   0\n 0  0        68044      7798424            0        38668  250 44982  3163 44982 9889 2454   3  25  70   1   0\n 0  0        67968      7794084            0        42796   16    0    16     1  190  168   0   0 100   0   0\n 0  0        67836      7793116            0        43968   13    0   130     0  181  166   0   0 100   0   0\n\n\n [root@lumenal1 ~]# free -h\n              total        used        free      shared  buff/cache   available\nMem:           7.6G        167M        7.4G        1.9M         42M        7.3G\nSwap:           15G         66M         15G\n\n")),(0,t.kt)("p",null,"Processes using swap space   "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'[root@lumenal1 ~]# egrep "Name|VmSwap" /proc/*/status|awk \'{ if( match($0,"Name:")){ split($1,arr,"/",seps); pid=arr[3]; name=$NF;} if(match($0,"VmSwap:")){ printf("[%8d] %-30s %10s (kb)\\n", pid, name, $(NF-1)); } }\'|sort -k4nr|head -n 15\n[     655] falcon-sensor                       14524 (kb)\n[    1321] tuned                               12932 (kb)\n[     714] polkitd                              6624 (kb)\n[    1326] rsyslogd                             2548 (kb)\n[    1264] dhclient                             2180 (kb)\n[    1125] dhclient                             1972 (kb)\n[   32718] sshd                                 1304 (kb)\n[   30128] sshd                                 1288 (kb)\n[    1323] sshd                                 1040 (kb)\n[       1] systemd                              1012 (kb)\n[     538] systemd-udevd                         788 (kb)\n[     720] ntpd                                  636 (kb)\n[     708] dbus-daemon                           604 (kb)\n[     748] crond                                 580 (kb)\n[     734] gssproxy                              516 (kb)\n')),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"(homework) Which process is using highest memory ?       ")),(0,t.kt)("h4",{id:"webex-chat-backup"},"Webex chat backup"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'from YUKI TERAI (IBM) to Everyone:    4:23  PM\n/proc/*/status\nfrom YUKI TERAI (IBM) to Everyone:    4:25  PM\ngrep VmSwap /proc/*/status | sort -k 2 -nr\nfrom SEOKHWAN CHOI (IBM) to Everyone:    4:27  PM\ntop -b -d 1  | tee -a top_`date +%Y%m%d_%H%M%S`.out\nfrom JUN SU LEE (IBM) to Everyone:    4:30  PM\nps aux|awk \'{ print $1" "$4; }\'|sort |perl -ne \'chomp($_); @arr=split(/\\s+/,$_); $user=$arr[0]; $pct=$arr[1]; $hash{$user} += $pct; END{ foreach $user( sort { $hash{$b} <=> $hash{$a} } keys %hash){ $val = $hash{$user}; printf("%30s => %6s\\n", $user, $val); } }\'\nfrom MASATO SADACHIKA (IBM) to Everyone:    4:31  PM\nI sometimes use procinfo -H for checking the memory usage.\nfrom YUKI TERAI (IBM) to Everyone:    4:39  PM\ngrep VmSwap /proc/*/status | sort -k 2 -nr\nfrom JUN SU LEE (IBM) to Everyone:    4:52  PM\negrep "Name|VmSwap" /proc/*/status|awk \'{ if( match($0,"Name:")){ split($1,arr,"/",seps); pid=arr[3]; name=$NF;} if(match($0,"VmSwap:")){ printf("[%8d] %-30s %10s (kb)\\n", pid, name, $(NF-1)); } }\'|sort -k4nr|head -n 15\nfrom FU FEI XU (IBM) to Everyone:    4:52  PM\nprintf \'Computing swap usage...\\n\';\nswap_usages="$(\n    SUM=0\n    OVERALL=0\n    for DIR in `find /proc/ -maxdepth 1 -type d -regex "^/proc/[0-9]+"`\n    do\n        PID="$(printf \'%s\' "$DIR" | cut -d / -f 3)"\n        PROGNAME=`ps -p $PID -o comm --no-headers`\n        for SWAP in `grep VmSwap $DIR/status 2>/dev/null | awk \'{ print $2 }\'`\n        do\n            let SUM=$SUM+$SWAP\n        done\n        if (( $SUM > 0 )); then\n            printf "$SUM KB ($PROGNAME) swapped PID=$PID\\\\n"\n        fi\n        let OVERALL=$OVERALL+$SUM\n        SUM=0\n        break\n    done\n    printf \'!!!! Overall swap used: %s KB\\n\' "$OVERALL"\n)"\nprintf \'%s\' "$swap_usages" | sort -nk1\nfrom JUN SU LEE (IBM) to Everyone:    4:55  PM\nWhich process is using highest memory ?\nfrom FU FEI XU (IBM) to Everyone:    5:00  PM\nvm.swappiness\nmin_free_kbytes\n')),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{parentName:"li",href:"#Contents"},"Go to content"))),(0,t.kt)("h4",{id:"scenario-2-high-user-cpu"},"Scenario #2 High User CPU"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"Test system : lumenal1.fyre.ibm.com , UID = root ( Ask password to Jun Su or Guo Dong )")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 ~]# su - recipe2\nLast login: Thu Feb 24 16:45:12 PST 2022 on pts/0\n\n==================================================\n\nThis recipe2 is simulating a High User CPU situation\n\nStart by using the command: vmstat -S M -w 5 or vmstat command you like to gauge the situation on the system\n\nRefer to the document: AnalyzingAndDebuggingPerfProblems.docx and go over the vmstat column section to understand the output\n\nAfter that check the Red Flags section in the document and see if any of those red flags match what you are seeing here\n\nTry and get the commands you can use from the document to use and then\n\n Try and answer the following questions:\n    1.How many CPU cores are on the box?\n    2.What is the difference between a socket, core and thread? How many sockets, cores and threads are on your server?\n    3.What the Load averages for 1 min, 15 min time period?\n    4.Is the problem intermittent?\n    5.What process is driving the high CPU usage?\n    6.What are the user calls which are driving the CPU usage?\n    7.After you logout, does the system go back to normal?\n\nFeel free to go back to the reference document and Answer Key\n\nThe answer key and reference document is available at:\n\nBox: https://ibm.box.com/s/9fa79a1hdbbyaqdcy8yrfh02b0unia40\n\nGithub: https://github.ibm.com/DB2-APD/Education/tree/master/Perf_Advanced\n")),(0,t.kt)("p",null,"1.How many CPU cores are on the box?"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'[recipe2@lumenal1 ~]$ lscpu\nArchitecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                4\nOn-line CPU(s) list:   0-3\nThread(s) per core:    1\nCore(s) per socket:    1\nSocket(s):             4\nNUMA node(s):          1\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 85\nModel name:            Intel Xeon Processor (Skylake, IBRS)\nStepping:              4\nCPU MHz:               2400.004\nBogoMIPS:              4800.00\nVirtualization:        VT-x\nHypervisor vendor:     KVM\nVirtualization type:   full\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              4096K\nL3 cache:              16384K\nNUMA node0 CPU(s):     0-3\nFlags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single ssbd ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 arat umip pku ospke md_clear spec_ctrl intel_stibp arch_capabilities\n\n[recipe2@lumenal1 ~]$ lscpu |grep "^CPU(s)"\nCPU(s):                4\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'\n[recipe2@lumenal1 ~]$ cat /proc/cpuinfo |grep "processor"\nprocessor   : 0\nprocessor   : 1\nprocessor   : 2\nprocessor   : 3\n')),(0,t.kt)("p",null,"2.What is the difference between a socket, core and thread? How many sockets, cores and threads are on your server?     "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 ~]# dmidecode\n# dmidecode 3.2\nGetting SMBIOS data from sysfs.\nSMBIOS 2.8 present.\n13 structures occupying 632 bytes.\nTable at 0xBFFFFD80.\n\nHandle 0x0000, DMI type 0, 24 bytes\nBIOS Information\n    Vendor: SeaBIOS\n    Version: 1.13.0-1ubuntu1.1\n    Release Date: 04/01/2014\n    Address: 0xE8000\n    Runtime Size: 96 kB\n    ROM Size: 64 kB\n    Characteristics:\n        BIOS characteristics not supported\n        Targeted content distribution is supported\n    BIOS Revision: 0.0\n\nHandle 0x0100, DMI type 1, 27 bytes\nSystem Information\n    Manufacturer: QEMU\n    Product Name: Standard PC (i440FX + PIIX, 1996)\n    Version: pc-i440fx-focal\n    Serial Number: Not Specified\n    UUID: ca158c60-5fa9-49e6-9f5c-20da15d57e63\n    Wake-up Type: Power Switch\n    SKU Number: Not Specified\n    Family: Not Specified\n\nHandle 0x0300, DMI type 3, 22 bytes\nChassis Information\n    Manufacturer: QEMU\n    Type: Other\n    Lock: Not Present\n    Version: pc-i440fx-focal\n    Serial Number: Not Specified\n    Asset Tag: Not Specified\n    Boot-up State: Safe\n    Power Supply State: Safe\n    Thermal State: Safe\n    Security Status: Unknown\n    OEM Information: 0x00000000\n    Height: Unspecified\n    Number Of Power Cords: Unspecified\n    Contained Elements: 0\n    SKU Number: Not Specified\n\nHandle 0x0400, DMI type 4, 42 bytes\nProcessor Information\n    Socket Designation: CPU 0\n    Type: Central Processor\n    Family: Other\n    Manufacturer: QEMU\n    ID: 54 06 05 00 FF FB 8B 0F\n    Version: pc-i440fx-focal\n    Voltage: Unknown\n    External Clock: Unknown\n    Max Speed: 2000 MHz\n    Current Speed: 2000 MHz\n    Status: Populated, Enabled\n    Upgrade: Other\n    L1 Cache Handle: Not Provided\n    L2 Cache Handle: Not Provided\n    L3 Cache Handle: Not Provided\n    Serial Number: Not Specified\n    Asset Tag: Not Specified\n    Part Number: Not Specified\n    Core Count: 1\n    Core Enabled: 1\n    Thread Count: 1\n    Characteristics: None\n\nHandle 0x0401, DMI type 4, 42 bytes\nProcessor Information\n    Socket Designation: CPU 1\n    Type: Central Processor\n    Family: Other\n    Manufacturer: QEMU\n    ID: 54 06 05 00 FF FB 8B 0F\n    Version: pc-i440fx-focal\n    Voltage: Unknown\n    External Clock: Unknown\n    Max Speed: 2000 MHz\n    Current Speed: 2000 MHz\n    Status: Populated, Enabled\n    Upgrade: Other\n    L1 Cache Handle: Not Provided\n    L2 Cache Handle: Not Provided\n    L3 Cache Handle: Not Provided\n    Serial Number: Not Specified\n    Asset Tag: Not Specified\n    Part Number: Not Specified\n    Core Count: 1\n    Core Enabled: 1\n    Thread Count: 1\n    Characteristics: None\n\nHandle 0x0402, DMI type 4, 42 bytes\nProcessor Information\n    Socket Designation: CPU 2\n    Type: Central Processor\n    Family: Other\n    Manufacturer: QEMU\n    ID: 54 06 05 00 FF FB 8B 0F\n    Version: pc-i440fx-focal\n    Voltage: Unknown\n    External Clock: Unknown\n    Max Speed: 2000 MHz\n    Current Speed: 2000 MHz\n    Status: Populated, Enabled\n    Upgrade: Other\n    L1 Cache Handle: Not Provided\n    L2 Cache Handle: Not Provided\n    L3 Cache Handle: Not Provided\n    Serial Number: Not Specified\n    Asset Tag: Not Specified\n    Part Number: Not Specified\n    Core Count: 1\n    Core Enabled: 1\n    Thread Count: 1\n    Characteristics: None\n\nHandle 0x0403, DMI type 4, 42 bytes\nProcessor Information\n    Socket Designation: CPU 3\n    Type: Central Processor\n    Family: Other\n    Manufacturer: QEMU\n    ID: 54 06 05 00 FF FB 8B 0F\n    Version: pc-i440fx-focal\n    Voltage: Unknown\n    External Clock: Unknown\n    Max Speed: 2000 MHz\n    Current Speed: 2000 MHz\n    Status: Populated, Enabled\n    Upgrade: Other\n    L1 Cache Handle: Not Provided\n    L2 Cache Handle: Not Provided\n    L3 Cache Handle: Not Provided\n    Serial Number: Not Specified\n    Asset Tag: Not Specified\n    Part Number: Not Specified\n    Core Count: 1\n    Core Enabled: 1\n    Thread Count: 1\n    Characteristics: None\n\nHandle 0x1000, DMI type 16, 23 bytes\nPhysical Memory Array\n    Location: Other\n    Use: System Memory\n    Error Correction Type: Multi-bit ECC\n    Maximum Capacity: 8 GB\n    Error Information Handle: Not Provided\n    Number Of Devices: 1\n\nHandle 0x1100, DMI type 17, 40 bytes\nMemory Device\n    Array Handle: 0x1000\n    Error Information Handle: Not Provided\n    Total Width: Unknown\n    Data Width: Unknown\n    Size: 8192 MB\n    Form Factor: DIMM\n    Set: None\n    Locator: DIMM 0\n    Bank Locator: Not Specified\n    Type: RAM\n    Type Detail: Other\n    Speed: Unknown\n    Manufacturer: QEMU\n    Serial Number: Not Specified\n    Asset Tag: Not Specified\n    Part Number: Not Specified\n    Rank: Unknown\n    Configured Memory Speed: Unknown\n    Minimum Voltage: Unknown\n    Maximum Voltage: Unknown\n    Configured Voltage: Unknown\n\nHandle 0x1300, DMI type 19, 31 bytes\nMemory Array Mapped Address\n    Starting Address: 0x00000000000\n    Ending Address: 0x000BFFFFFFF\n    Range Size: 3 GB\n    Physical Array Handle: 0x1000\n    Partition Width: 1\n\nHandle 0x1301, DMI type 19, 31 bytes\nMemory Array Mapped Address\n    Starting Address: 0x00100000000\n    Ending Address: 0x0023FFFFFFF\n    Range Size: 5 GB\n    Physical Array Handle: 0x1000\n    Partition Width: 1\n\nHandle 0x2000, DMI type 32, 11 bytes\nSystem Boot Information\n    Status: No errors detected\n\nHandle 0x7F00, DMI type 127, 4 bytes\nEnd Of Table\n")),(0,t.kt)("p",null,"3.What the Load averages for 1 min, 15 min time period? "),(0,t.kt)("p",null,"for the past 1, 5, and 15 minutes.    "),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 ~]# uptime\n 19:34:28 up 11 days,  1:24,  3 users,  load average: 7.86, 6.52, 3.61\n")),(0,t.kt)("ol",{start:4},(0,t.kt)("li",{parentName:"ol"},"Is the problem intermittent?",(0,t.kt)("br",{parentName:"li"}),"YES ")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[recipe2@lumenal1 ~]$ vmstat -S M -w 5 \nprocs -----------------------memory---------------------- ---swap-- -----io---- -system-- --------cpu--------\n r  b         swpd         free         buff        cache   si   so    bi    bo   in   cs  us  sy  id  wa  st\n 7  0           59         7394            0          237    0    0     1     7    9    2   0   0 100   0   0\n 2  0           59         7394            0          237    0    0     0     0 2068   73  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2060   67  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     1 2067   69  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2056   56  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     4 2060   59  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2057   57  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2074   81  50   0  50   0   0\n 2  0           59         7394            0          237    0    0    14     0 2075   82  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0    27 2147  150  50   0  49   0   0\n 2  0           59         7394            0          237    0    0     0     0 2085  104  50   0  50   0   0\n 6  0           59         7394            0          237    0    0     2     2 2310  141  55   0  45   0   0\n 6  0           59         7394            0          237    0    0     0     0 4070  286 100   0   0   0   0\n 6  0           59         7394            0          237    0    0     0     0 4072  294 100   0   0   0   0\n 6  0           59         7394            0          237    0    0     0     0 4089  293 100   0   0   0   0\n 6  0           59         7394            0          237    0    0     3     4 4080  296 100   0   0   0   0\n 6  0           59         7394            0          237    0    0     0     0 4086  294 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4107  322 100   0   0   0   0\n20  0           59         7394            0          237    0    0     0     0 4116  429 100   0   0   0   0\n20  0           59         7394            0          237    0    0     0     0 4160  439 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4139  434 100   0   0   0   0\nprocs -----------------------memory---------------------- ---swap-- -----io---- -system-- --------cpu--------\n r  b         swpd         free         buff        cache   si   so    bi    bo   in   cs  us  sy  id  wa  st\n22  0           59         7394            0          237    0    0     0     3 4200  433 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4148  418 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4108  415 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4155  412 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4125  418 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4159  414 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4138  425 100   0   0   0   0\n21  0           59         7394            0          237    0    0     0     0 4135  411 100   0   0   0   0\n 0  0           59         7394            0          237    0    0     0     0 3837  413  92   0   8   0   0\n 0  0           59         7394            0          237    0    0     0     0   88   71   0   0 100   0   0\n 2  0           59         7394            0          237    0    0     0     0  250   84   4   0  96   0   0\n 2  0           59         7394            0          237    0    0     0     0 2064   69  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2071   78  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2071   72  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2067   73  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2069   69  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2082   91  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     2     0 2181  147  51   0  48   0   0\n 2  0           59         7394            0          237    0    0     0     4 2075   80  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2084   85  50   0  50   0   0\n 2  0           59         7394            0          237    0    0     0     0 2069   74  50   0  50   0   0\nprocs -----------------------memory---------------------- ---swap-- -----io---- -system-- --------cpu--------\n r  b         swpd         free         buff        cache   si   so    bi    bo   in   cs  us  sy  id  wa  st\n 3  0           59         7394            0          237    0    0     0     0 2071   69  50   0  50   0   0\n 9  0           59         7386            0          240    0    0   782     0 2412  262  54   1  45   0   0\n 6  0           59         7389            0          240    0    0     2     0 4129  304 100   0   0   0   0\n 6  0           59         7389            0          240    0    0     0    47 4083  282 100   0   0   0   0\n 6  0           59         7389            0          240    0    0     0     0 4089  286 100   0   0   0   0\n 8  0           59         7388            0          240    0    0     0     0 4104  311 100   0   0   0   0\n 6  0           59         7388            0          240    0    0     0     0 4080  293 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4115  319 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     2 4093  431 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0    79 4131  440 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4117  434 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4124  432 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4120  429 100   0   0   0   0\n21  0           59         7387            0          240    0    0     0     0 4101  436 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4083  429 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0    14 4120  412 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4101  405 100   0   0   0   0\n21  0           59         7387            0          240    0    0     0     0 4122  406 100   0   0   0   0\n20  0           59         7387            0          240    0    0     0     0 4089  403 100   0   0   0   0\n...\n")),(0,t.kt)("p",null,"5.What process is driving the high CPU usage?"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 recipe2]# top -c -b -o +%CPU | head -20\ntop - 19:39:32 up 11 days,  1:29,  3 users,  load average: 11.00, 9.02, 5.46\nTasks: 160 total,   1 running, 155 sleeping,   4 stopped,   0 zombie\n%Cpu(s): 49.3 us,  3.0 sy,  0.0 ni, 47.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  8008600 total,  7564016 free,   196864 used,   247720 buff/cache\nKiB Swap: 16773116 total, 16711956 free,    61160 used.  7576848 avail Mem\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND\n32453 recipe2   20   0   22900    392    312 S 193.8  0.0   0:20.96 /.scripts/+\n    1 root      20   0   51900   2408   1472 S   0.0  0.0   3:22.06 /usr/lib/s+\n    2 root      20   0       0      0      0 S   0.0  0.0   0:00.15 [kthreadd]\n    4 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 [kworker/0+\n...\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 recipe2]# ps aux --sort -%cpu | head -n 10\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nrecipe2  32551  413  0.0 170428   656 pts/1    Sl   19:40   0:28 /.scripts/prog1 20\nroot         1  0.0  0.0  51900  2408 ?        Ss   May28   3:22 /usr/lib/systemd/systemd --switched-root --system --deserialize 22\nroot         2  0.0  0.0      0     0 ?        S    May28   0:00 [kthreadd]\nroot         4  0.0  0.0      0     0 ?        S<   May28   0:00 [kworker/0:0H]\nroot         6  0.0  0.0      0     0 ?        S    May28   0:00 [ksoftirqd/0]\nroot         7  0.0  0.0      0     0 ?        S    May28   0:00 [migration/0]\nroot         8  0.0  0.0      0     0 ?        S    May28   0:00 [rcu_bh]\nroot         9  0.0  0.0      0     0 ?        R    May28   3:38 [rcu_sched]\nroot        10  0.0  0.0      0     0 ?        S<   May28   0:00 [lru-add-drain]\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 ~]# ps H -eo user,pid,ppid,tid,time,%cpu,cmd --sort=-%cpu\n...\n")),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"$ cat .bashrc\n...\n( nohup /.scripts/run_prog1 > /dev/null 2>&1 & )\n...")),(0,t.kt)("p",null,"6.What are the user calls which are driving the CPU usage?"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[root@lumenal1 ~]# pstack 16075\nThread 21 (Thread 0x7f23b5d4b700 (LWP 16077)):\n#0  0x0000000000400aa5 in waste_some_cpu ()\n#1  0x0000000000400a77 in use_usr_cpu ()\n#2  0x00007f23b6121ea5 in start_thread () from /lib64/libpthread.so.0\n#3  0x00007f23b5e4ab0d in clone () from /lib64/libc.so.6\nThread 20 (Thread 0x7f23b554a700 (LWP 16078)):\n#0  0x0000000000400a9e in waste_some_cpu ()\n#1  0x0000000000400a77 in use_usr_cpu ()\n#2  0x00007f23b6121ea5 in start_thread () from /lib64/libpthread.so.0\n#3  0x00007f23b5e4ab0d in clone () from /lib64/libc.so.6\n...\n")))}m.isMDXComponent=!0}}]);